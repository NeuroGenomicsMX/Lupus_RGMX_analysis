"0","bd.entrenamiento <- sample_frac(variables.interes, 0.7)"
"0","id.entrenamiento <- as.numeric(row.names(bd.entrenamiento))"
"0","bd.prueba <- variables.interes[-id.entrenamiento,]"
"0","levels(variables.interes$bref1)"
"1","[1]"
"1"," ""L"""
"1"," ""H"""
"1","
"
"0","bd.entrenamiento$bref1<-relevel(bd.entrenamiento$bref1, ref = ""L"")"
"0","library(nnet)"
"0","modelo.1<-multinom(bref1 ~ "
"0","                     socioeconomic_status +"
"0","                     dx_time +"
"0","                     bref2 +"
"0","                     treatment___0 +"
"0","                     treatment___1 +"
"0","                     treatment___6 +"
"0","                     treatment___7 +"
"0","                     prednisolona.0 +"
"0","                     prednisolona.1 +"
"0","                     age_group ,"
"0","                   data = bd.entrenamiento)"
"1","# weights: "
"1"," "
"1","15"
"1"," ("
"1",""
"1","14"
"1",""
"1"," variable)
"
"1","initial  value 435.989577 
"
"1","iter  10 value 389.422224
"
"1","final  value 385.766359 
"
"1","converged
"
"0","summary(modelo.1)"
"2","Warning: Se han producido NaNs"
"1","Call:
"
"1","multinom(formula = bref1 ~ socioeconomic_status + dx_time + bref2 + 
"
"1","    treatment___0 + treatment___1 + treatment___6 + treatment___7 + 
"
"1","    prednisolona.0 + prednisolona.1 + age_group, data = bd.entrenamiento)
"
"1","
Coefficients:
"
"1","                    "
"1","       Values"
"1","  Std. Err."
"1","
(Intercept)         "
"1"," -1.761514724"
"1"," 0.56947773"
"1","
socioeconomic_status"
"1","  0.008367345"
"1"," 0.00329868"
"1","
dx_time             "
"1","  0.008379959"
"1"," 0.01298325"
"1","
bref2B              "
"1","  0.232466540"
"1"," 0.34161302"
"1","
bref2C              "
"1","  0.870311516"
"1"," 0.33228655"
"1","
bref2D              "
"1","  2.113934144"
"1"," 0.35820423"
"1","
bref2F              "
"1","  0.000000000"
"1","        NaN"
"1","
treatment___0       "
"1","  0.102886639"
"1"," 0.31122525"
"1","
treatment___1       "
"1"," -0.228188880"
"1"," 0.28526052"
"1","
treatment___6       "
"1","  0.407032548"
"1"," 1.55933371"
"1","
treatment___7       "
"1"," -0.319980434"
"1"," 1.14653931"
"1","
prednisolona.0      "
"1"," -0.375066524"
"1"," 0.29912362"
"1","
prednisolona.1      "
"1"," -0.199949356"
"1"," 0.34968325"
"1","
age_group           "
"1","  0.089845320"
"1"," 0.09257662"
"1","
"
"1","
Residual Deviance:"
"1"," "
"1","771.5327"
"1"," "
"1","
"
"1","AIC:"
"1"," "
"1","797.5327"
"1"," "
"1","
"
"0","exp(coef(modelo.1))"
"1","         (Intercept) "
"1","socioeconomic_status "
"1","             dx_time "
"1","              bref2B "
"1","
"
"1","           0.1717845 "
"1","           1.0084024 "
"1","           1.0084152 "
"1","           1.2617082 "
"1","
"
"1","              bref2C "
"1","              bref2D "
"1","              bref2F "
"1","       treatment___0 "
"1","
"
"1","           2.3876545 "
"1","           8.2807550 "
"1","           1.0000000 "
"1","           1.1083658 "
"1","
"
"1","       treatment___1 "
"1","       treatment___6 "
"1","       treatment___7 "
"1","      prednisolona.0 "
"1","
"
"1","           0.7959739 "
"1","           1.5023530 "
"1","           0.7261632 "
"1","           0.6872436 "
"1","
"
"1","      prednisolona.1 "
"1","           age_group "
"1","
"
"1","           0.8187722 "
"1","           1.0940050 "
"1","
"
"0","tabla.de.probabilidades <- fitted(modelo.1)"
"0","head(tabla.de.probabilidades)"
"1","    "
"1","      [,1]"
"1","
183 "
"1"," 0.8710585"
"1","
1116"
"1"," 0.3282744"
"1","
289 "
"1"," 0.3729659"
"1","
748 "
"1"," 0.8299245"
"1","
229 "
"1"," 0.5267735"
"1","
475 "
"1"," 0.7244602"
"1","
"
"0","bd.entrenamiento$Prediccion <- predict(modelo.1, newdata = bd.entrenamiento, ""class"")"
"0","tabla.de.comparacion <- table(bd.entrenamiento$bref1, bd.entrenamiento$Prediccion)"
"0","diag(tabla.de.comparacion)"
"1","  L "
"1","  H "
"1","
"
"1","257 "
"1","156 "
"1","
"
"0","table(bd.entrenamiento$bref1)"
"1","
"
"1","  L "
"1","  H "
"1","
"
"1","334 "
"1","295 "
"1","
"
"0","diag(tabla.de.comparacion) / table(bd.entrenamiento$bref1)"
"1","
"
"1","        L "
"1","        H "
"1","
"
"1","0.7694611 "
"1","0.5288136 "
"1","
"
"0","sum(diag(tabla.de.comparacion)) / sum(tabla.de.comparacion)"
"1","[1]"
"1"," 0.6565978"
"1","
"
